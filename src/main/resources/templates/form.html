<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>BookRecord</title>
    <link rel="stylesheet" th:href="@{/style.css}">
</head>
<body>
    <h1>BookRecord</h1>
    <div>図書館で借りた本を記録してください</div>
    <div>（<span class="required">*</span>の項目は入力必須）</div>

    <!-- 投稿フォーム -->
    <form th:action="@{/add}" method="post" th:object="${post}" class="post-form">
        <div class="form-group">
            <label for="title">タイトル：<span class="required">*</span></label>
            <input type="text" th:field="*{title}" class="form-input">
            <span th:if="${#fields.hasErrors('title')}" th:errors="*{title}" class="error"></span>
        </div>

        <div class="form-group">
            <label for="author">著者：<span class="required">*</span></label>
            <input type="text" th:field="*{author}" class="form-input">
            <span th:if="${#fields.hasErrors('author')}" th:errors="*{author}" class="error"></span>
        </div>

        <div class="form-group">
            <label for="memo">メモ：</label>
            <textarea th:field="*{memo}" rows="4" class="form-input"></textarea>
			<span th:if="${#fields.hasErrors('memo')}" th:errors="*{memo}" class="error"></span>
        </div>

        <div class="form-group">
            <label for="borrowDate">借りた日：</label>
            <input type="date" th:field="*{borrowDate}" class="form-input">
        </div>
		<br>
        <button type="submit" class="btn">投稿</button>
    </form>

    <br>

    <!-- 投稿一覧 -->
    <h2>一覧</h2>
	<div>☆をクリックするとお気に入り登録できます</div>
    <table>
		<thead>
        <tr>
            <th>ID</th>
            <th>タイトル</th>
            <th>著者</th>
            <th>メモ</th>
            <th>借りた日</th>
            <th>返却予定日</th>
            <th></th>
            <th></th>
        </tr>
		</thead>
		<tbody>
        <tr th:each="post : ${posts}">
            <td th:text="${post.id}"></td>
            <td th:text="${post.title}"></td>
            <td th:text="${post.author}"></td>
            <td th:text="${post.memo}"></td>
            <td th:text="${post.borrowDate}"></td>
            <td th:text="${post.returnDate}"></td>

            <td>
                <form method="post" th:action="@{'/favorite/' + ${post.id}}">
                    <button type="submit" class="favorite-btn">
                        <span th:text="${post.favorite} ? '⭐️' : '☆'" th:class="${post.favorite} ? 'star-on' : 'star-off'"></span>
                    </button>
                </form>
            </td>

            <td>
				<form th:action="@{/delete/{id}(id=${post.id})}" method="post" onsubmit="return confirm('本当に削除しますか？')">
				    <button type="submit" class="btn">削除</button>
				</form>
            </td>
        </tr>
		</tbody>
    </table>
</body>
</html>
